#!/usr/bin/env php
<?php

/*
 * This file is part of the symfony package.
 * (c) Fabien Potencier <fabien.potencier@symfony-project.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

$original_dir = getcwd();
while(!is_file('symfony')) // traverse parent directories to find symfony project root
{
  $last_dir = getcwd();

  if(@is_readable($last_dir.DIRECTORY_SEPARATOR.'..'))
  {
    @chdir('..');
  }

  $current_dir = getcwd();
  if ($current_dir == $last_dir || $current_dir == '/') // if you get to the top go back to where you started
  {
    chdir($original_dir);
    break;
  }
}

// project exists?
if (@file_exists('config/config.php'))
{
  include('config/config.php');
}

if (!isset($sf_symfony_lib_dir))
{
  if (@is_readable(dirname(__FILE__).'/../../lib/autoload/sfCoreAutoload.class.php'))
  {
    // SVN
    $sf_symfony_lib_dir  = realpath(dirname(__FILE__).'/../../lib');
  }
  else
  {
    // PEAR
    $sf_symfony_lib_dir  = '@PEAR-DIR@/symfony';

    if (!is_dir($sf_symfony_lib_dir))
    {
      throw new Exception('Unable to find symfony libraries');
    }
  }
}

require($sf_symfony_lib_dir.'/command/cli.php');
